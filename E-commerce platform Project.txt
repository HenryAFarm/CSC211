//E-commerce Project by Henry Arevalo
import java.util.List;
import java.util.Comparator;
import java.util.stream.Collectors;
import java.util.ArrayList;

//Superclass#1
class User {
    private String fName;
    private String lName;
    
    //no-arg constructor
    public User () {
        fName = "Unknown";
        lName = "Unknown";
    }
    //constructor
    public User (String fName, String lName) {
        this.fName = fName;
        this.lName = lName;
    }
    
    public String getfName(){
        return fName;
    }
    public String getlName(){
        return lName;
    }
    //edit later
    public String toString(){
        String s = "First name is: " + fName + " Last name is " + lName;
        return s;
    }
    
}
//subclass for user
class Customer extends User {
    private int CustomerID;
    //to hold items of the Customer
    private List<Product> shoppingCart;
    
    public Customer (String fName, String lName, int CustomerID){
        super(fName, lName);
        this.CustomerID = CustomerID;
        this.shoppingCart = new ArrayList<>();
        
    }
    
    public void addToCart(Product p){
        this.shoppingCart.add(p);
    }
    
    public void removeFromCart(Product p){
        this.shoppingCart.remove(p);
    }
    
    public List<Product> getShoppingCart() {
        return shoppingCart;
    }
    
    public int getCustomerID(){
        return CustomerID;
    }
    
    
}
//subclass for user
class Admin extends User {
    private int ID;
    private String accessLevel;
    
    public Admin (String fName, String lName, int ID, String accessLevel){
        super(fName, lName);
        this.ID = ID;
        this.accessLevel = accessLevel;
        
    }
    //To introduce new products
    public void addProduct(Product p, List<Product> catalog){
        catalog.add(p);
        System.out.println("ADMIN: Added product--- " + p.getName());
        
    }
    
    //To change the price of an existing items
    public void updatePrice(Product p, double newPrice){
        p.setPrice(newPrice);
        System.out.printf("ADMIN: Change price of: %s price updated to $%.2f%n", p.getName(), newPrice);
    }
    
    //To remove an item
    public void removeProduct(Product p, List<Product> catalog){
        catalog.remove(p);
        System.out.println("ADMIN: " + p.getName() + " removed.");
    }
    
    //To see the orders that the many customer have ordered
    public void allOrders(List<Order> orders){
        for(Order o : orders) {
            System.out.println(o.toString());
            
        }
    }
    
    //to mark an order
     public void orderStatus(Order o, String newStatus){
        o.setStatus(newStatus);
       System.out.println("Order " + o.getID() + " Status set to " + newStatus);
    }
    
    // To look up a customers information
    public void CustomerDetails(Customer c){
        System.out.println("\n----- Customer Details -----");
        System.out.println("Customer Name: " + c.getfName() + " " + c.getlName());
        System.out.println("Customer ID: " + c.getCustomerID());
        System.out.println("Cart size: " + c.getShoppingCart().size());
    }
    
    //the getter
    public String getAccessLevel(){
        return accessLevel;
    }
    @Override
    public String toString(){
        String s = "Admin: " + getfName() +" "+ getlName();
        return s;
    }
        
}

//Superclass#2
class Product {
    private String Name;
    private String Category;
    private double Price;
    private String ProductID;
    
    //no-arg
    public Product(){
      Name = "Unknown";
      Category = "Unknown";
      Price = 0.00;
      ProductID = "0000";
    }
    // the constructor
    public Product(String Name, String Category, double Price, String ProductID){
       this.Name = Name;
       this.Category = Category;
       this.Price = Price;
       this.ProductID = ProductID;
    }
    
    public void setPrice(double newPrice){
        Price = newPrice;
    }
    
    public double getPrice(){
        return Price;
    }
    public String getName(){
        return Name;
    }
    public String getCategory(){
        return Category;
    }
    
    //purpose to list everyItem. 
    public String toString(){
        String s = "All the items: "+ Name;
        return s;
        
    }
}
//subclass for product
class Electronics extends Product {
    public Electronics(String Name, double Price, String ProductID) {
    super(Name, "Electronics", Price, ProductID); 
}
    
    
}
//subclass for product
class Clothing extends Product {
    public Clothing(String Name, double Price, String ProductID) {
    super(Name, "Clothes", Price, ProductID); 
    
    } 
}
//subclass for product
class Grocery extends Product {
    public Grocery(String Name, double Price, String ProductID) {
    super(Name, "Grocery", Price, ProductID); 
     
    } 
}

//Class for calculation
class Order {
    private Customer customer;
    private List<Product> items;
    private double subtotal;
    private double totalAmount;
    private final double TAX_RATE = 0.0875;
    private final double SHIPPING_FEE = 2.50;
    private String finalOrder;
    private String status;
    
    public Order(Customer customer, List<Product> items){
        this.customer = customer;
        this.items = new ArrayList<>(items);
        this.subtotal = calculateSubtotal(this.items);
        this.totalAmount = 0.0;
        this.status = "PENDING";
        
    }
    
    //setter
    public void setStatus(String newStatus){
        this.status = newStatus;
    }
    
    
    public double calculateSubtotal(List<Product> cart) {
        //adds items together
        return cart.stream()
               .mapToDouble(Product::getPrice)
               .sum();
        
    }
    // add the tax and fees
    public double calculateTotal(){
    return this.subtotal * (1 + TAX_RATE) + SHIPPING_FEE;
    }
    
    public void processOrder(){
        this.totalAmount = calculateTotal();
        
    System.out.println("Order processed successfully for Customer ID: " + customer.getCustomerID());
    System.out.printf("Subtotal: $%.2f%n", this.subtotal);
    System.out.printf("Total Amount Due: $%.2f%n", this.totalAmount);
    }
    //getter and tem
    public String getID() { 
        return "ORDER- " + this.customer.getCustomerID() + "-" + (int)(Math.random() * 1000); 
        
    } 
   
    @Override   
    public String toString() {
        return String.format("Order for %s | ID: %s | Status: %s | Total: $%.2f", 
            customer.getfName(), this.getID(), this.status, this.totalAmount);
    }
    
}


public class Main{
	public static void main(String[] args) {

	    
	    //The setup
	    List<Product> catalog = new ArrayList<>();
        catalog.add(new Electronics("Laptop", 1200.00, "E1001"));
        catalog.add(new Electronics("iphone 15", 450.99, "E1002"));
        catalog.add(new Electronics("iphone 16", 690.99, "E1012"));
        catalog.add(new Electronics("iphone 17", 1100.99, "E1018"));
        catalog.add(new Clothing("Gucci", 2500.99, "C2000"));
        catalog.add(new Clothing("Louis Vuitton", 768.99, "C5001"));
        catalog.add(new Clothing("Nike", 101.99, "C2001"));
        catalog.add(new Clothing("Forever 21", 49.99, "C2021"));
        catalog.add(new Grocery("Apples", 4.99, "G3001"));
        catalog.add(new Grocery("Bananas", 1.99, "G2001"));
        catalog.add(new Grocery("Orange", 0.99, "G7474"));
        catalog.add(new Grocery("Carrot", 6.99, "G1833"));
        
        //User 
	    //first customer
	    Customer customer1 = new Customer("Henry", "Doe", 101);
        customer1.addToCart(catalog.get(0)); 
        customer1.addToCart(catalog.get(9));
        customer1.addToCart(catalog.get(7));
        
        
        System.out.println("----E-Commerce Operations----");
	    
	    //lambda expressions
	   List<Product> electronics = catalog.stream()
            .filter(p -> p.getCategory().equals("Electronics"))
            .collect(Collectors.toList()); 
        
        System.out.println("\nFiltered Products (Electronics):");
        electronics.forEach(p -> System.out.println(p.getName() + " ($" + p.getPrice() + ")"));
	    
	    
	    //search
	    List<Product> searchResults = catalog.stream()
            .filter(p -> p.getName().contains("iphone 15"))
            .collect(Collectors.toList());
	    
	    System.out.println("customer1 is searching: ");
	    System.out.println("\nSearch Results (Contains 'iphone 15'):");
        searchResults.forEach(p -> System.out.println("Item has been found: " + p.getName()));
        
        
        //sorting
        List<Product> sortedByPrice = catalog.stream()
            .sorted(Comparator.comparingDouble(Product::getPrice))
            .collect(Collectors.toList());
            
        System.out.println("\n Products Sorted by Price (Low to High):");
        sortedByPrice.forEach(p -> System.out.printf("%-20s $%.2f%n", p.getName(), p.getPrice()));
	    
	    //Applying discounts of 10%
	    double discountRate = 0.10; 
        double discountedTotal = catalog.stream()
	        .mapToDouble(p -> p.getPrice() * (1 - discountRate))
            .sum();
        System.out.printf("\n Discount (10%% off all items):\nTotal discounted cart price: $%.2f%n", discountedTotal);
	    
	    
	    System.out.println("");
	    
	      //ADMIN
	    Admin adminUser = new Admin("Jane", "Frances", 999, "Company");
	    System.out.println("---ADMIN OPERATION---");
	    
	   System.out.println(adminUser.toString());
	    //adding a product
	    Product newGadget = new Electronics("Smart Watch", 350.00, "E1099");
        adminUser.addProduct(newGadget, catalog);
        
        //changing the price of a Product
        Product laptop = catalog.get(0);
        adminUser.updatePrice(laptop, 1150.00);
        
        //views customer Details
        adminUser.CustomerDetails(customer1);
        
        //finalized the order
        Order finalOrder = new Order(customer1, customer1.getShoppingCart());
        finalOrder.processOrder();
	    
	    //changing the status of order
	    adminUser.orderStatus(finalOrder, "SHIPPED"); 
        
        //testing
        System.out.println("\nOrder:");
        System.out.println(finalOrder.toString());
}}
